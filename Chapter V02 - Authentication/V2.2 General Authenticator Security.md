# V2.2 General Authenticator Security

## 2.2.1 Verify that anti-automation controls are effective at mitigating breached credential testing, brute force, and account lockout attacks

Om een applicatie binnen te dringen maken aanvallers gebruik van zogenaamde brute-force aanvallen. Hierbij proberen ze een grote combinatie van gebruikersnamen en wachtwoorden om op die manier een valide combinatie te vinden. Het is belangrijk dat er maatregelen zijn genomen om dit te voorkomen, echter is het hierbij belangrijk dat door deze maatregelen geen nieuwe kwetsbaarheden worden geïntroduceerd die mogelijk tot account lockout kunnen leiden. Hierbij is als laatste tip meegegeven dat het nooit mogelijk moet zijn om meer dan 100 pogingen per uur te doen op een account.

### Hoe te testen?

#### Optie 1 (manueel)

De makkelijkste manier is om te definiëren wanneer de verwachte blokkades intreden en deze te testen door deze drempelwaarde te overschrijden. e.g:

- Na 10 foutieve pogingen wordt een IP-adres geblokkeerd voor 10 minuten.
- Na 3 foutieve pogingen wordt een account tijdelijk geblokkeerd.
- Het is alleen mogelijk om vanuit een Nederlandse IP in te loggen.
- Het is alleen mogelijk om via een overheid approved laptop in te loggen.

### Hoe te implementeren?

Volg de [Best Practice - Wachtwoorden](../Best%20Practices/Best%20Practice%20-%20Wachtwoorden.md). Meer informatie kan ook worden gevonden op: <https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks>

## 2.2.2 Verify that the use of weak authenticators (such as SMS and email) is limited to secondary verification and transaction approval and not as a replacement for more secure authentication methods

Met de introductie van multi-factor authenticatie (e.g. wachtwoord i.c.m. een SMS, e-mail of authenticatie-app) komt het in enkele gevallen ook voor dat er enkel voor een email / sms code wordt gekozen vanwege gebruikersgemak. Het advies is dit niet te doen en enkel emails of sms als als secondaire controle toe laten staan.

### Hoe te testen?

#### Optie 1 (manueel)

Controleer dat SMS en email enkel als secondaire verificatie worden toegestaan.

### Hoe te implementeren?

[Best Practice - MFA](/Concepten/Security/iSDP/Best%20Practices/Best%20Practice%20-%20MFA.md)

## 2.2.3 Verify that secure notifications are sent to users after updates to authentication details, such as credential resets, email or address changes, logging in from unknown or risky locations

Op het moment dat er belangrijke dingen wijzigen is het fijn als je hier van op de hoogte wordt gesteld. Dit zodat, indien iemand toegang krijgt tot je account en een ingrijpende wijziging aanbrengt, je dit nog kan voorkomen of terugdraaien. Hierbij hebben push notificaties de voorkeur maar naar verwachting is een melding via email of SMS de enige mogelijke optie, dit heeft in dat geval de voorkeur over niks.

### Hoe te testen?

#### Optie 1 (manueel)

Let op: Er zit hier een balans tussen beveiliging, privacy en gebruiksvriendelijkheid. Indien er een wijziging wordt gedaan is het niet de bedoeling dat de volledige wijzigingsdetails over e-mail worden verstuurd. Een oplossing hiervoor zou kunnen zijn om een deel van de data weg te laten en alleen de laatste 2-3 cijfers oid te tonen in de e-mail, maar wel te beschrijven wat er is gewijzigd (dus "het bankrekeningnummer is update naar ****123."). Overleg dit met je privacy of security liaison.

1. Maak een belangrijke wijziging op een account, e.g. het IBAN nummer.
2. Controleer of er een mail binnenkomt.

### Hoe te implementeren?

1. Definieer de belangrijke acties binnen je applicatie
2. Implementeer een notificatie service
3. Implementeer notificaties bij uitvoer belangrijke actie.
