# V2.5 Credential Recovery

## 2.5.1 Verify that a system generated initial activation or recovery secret is not sent in clear text to the user

Omdat recovery secrets of initiële secrets vaak dezelfde toegang verschaffen als wachtwoorden is het belangrijk dat deze op een veilige manier worden beheerd en verstuurd. Indien deze tokens dan ook bij een gebruiker terecht moeten komen is het belangrijk dat deze te versturen via veilige communicatiekanalen zoals HTTPS. Ook dient de uiteindelijke token encrypted opgeslagen te worden in de database.

### Hoe te testen?

#### Optie 1 (manueel)

Onderzoek in de code of secrets enkel via versleutelde kanalen wordt verstuurd.

### Hoe te implementeren?

Maak gebruik van de functionaliteit in de authenticatie framework voor het versturen van deze secrets, bouw geen eigen implementatie.

## 2.5.2 Verify password hints or knowledge-based authentication (so-called "secret questions") are not present

Een tijd geleden was het een standaard om een wachtwoord herstel te kunnen doen met zogenaamde "geheime vragen", omdat dit makkelijker is te achterhalen, door middel van bijvoorbeeld phishing wordt dit tegenwoordig gezien als minder veilig. Om deze reden is het gebruik van "secret questions" afgeraden.

### Hoe te testen?

#### Optie 1 (manueel)

Onderzoek of het mogelijk is om een wachtwoord herstel uit te voeren via "secret questions", zo niet is het in orde.

### Hoe te implementeren?

Verwijder functionaliteit die het toestaat om een wachtwoord herstel met "secret questions" uit te voeren.

## 2.5.3 Verify password credential recovery does not reveal the current password in any way

Op het moment dat een wachtwoord kan worden verstuurd bij wachtwoord herstel impliceert dit dat het wachtwoord zonder gebruik van hashing is opgeslagen.

### Hoe te testen?

#### Optie 1 (manueel)

1. Controleer dat er nergens plain text wachtwoorden worden verstuurd.
2. Controleer dat wachtwoorden met hash functies worden opgeslagen.

### Hoe te implementeren?

Maak gebruik van hashing voor je wachtwoorden waardoor het niet mogelijk is deze plain text te achterhalen. Voor aanbevelingen over welke hashing te gebruiken zie, [Best Practice - Cryptografie](../Best%20Practices/Best%20Practice%20-%20Cryptografie.md).

## 2.5.4 Verify shared or default accounts are not present (e.g. "root", "admin", or "sa")

Het gebruik van een standaard account maakt het loggen van welke acties door wie zijn uitgevoerd onmogelijk. Dit omdat alles vanuit een gedeeld of standaard account is gedaan waardoor er geen accountability is.

### Hoe te testen?

#### Optie 1 (manueel)

Controleer dat er geen standaard accounts in gebruik zijn.

### Hoe te implementeren?

Disable of verwijder standaard gebruikenaccounts en creëer een persoonlijk account voor elke gebruiker met de benodigde rechten.

## 2.5.5 Verify that if an authentication factor is changed or replaced, that the user is notified of this event

Op het moment dat er belangrijke dingen wijzigen is het fijn als je hier van op de hoogte wordt gesteld. Dit zodat indien iemand toegang krijgt tot je account en een ingrijpende wijziging aanbrengt je dit nog kan voorkomen of terugdraaien. Hierbij hebben push notificaties de voorkeur maar naar verwachting is een melding via email of SMS de enige mogelijke optie, dit heeft in dat geval de voorkeur over niks.

### Hoe te testen?

#### Optie 1 (manueel)

1. Wijzig het wachtwoord, of de MFA.
2. Controleer dat er een melding binnenkomt.

### Hoe te implementeren?

1. Definieer de belangrijke acties binnen je applicatie
2. Implementeer een notificatie service
3. Implementeer notificaties bij uitvoer belangrijke actie.
4. Verifieer dat er geen gevoelige informatie in de notificatie wordt verstuurd.

## 2.5.6 Verify forgotten password, and other recovery paths use a secure recovery mechanism, such as time-based OTP (TOTP) or other soft token, mobile push, or another offline recovery mechanism

Door middel van wachtwoord herstel is het in veel gevallen mogelijk om bijvoorbeeld MFA te omzeilen. Om deze reden is het belangrijk dat er een mechanisme beschikbaar is dit er voor zorgt dat via de wachtwoordherstelmethoden, de wachtwoordbeveiliging wordt ondermijnd.

### Hoe te testen?

#### Optie 1 (manueel)

1. Vraag een wachtwoord aan via "Wachtwoord vergeten"
2. Kijk of er bevestiging wordt gevraagd door middel van een soft token.

### Hoe te implementeren?

Zorg dat de best practices worden gevolgd als het gaat om wachtwoord recovery. <https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html>
