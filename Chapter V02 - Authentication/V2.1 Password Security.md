# V2.1 Password Security

## 2.1.1 Verify that user set passwords are at least 12 characters in length (after multiple spaces are combined)

Met de huidige computerkracht om wachtwoorden te brute-forceren (grote hoeveelheid pogingen om wachtwoord te raden) is het belangrijk om een lang wachtwoord te hebben. Om dit te bewerkstelen is een minimale lengte belangrijk.

### Hoe te testen?

#### Optie 1 (manueel)

1. Test of het mogelijk is om het volgende wachtwoord te gebruiken:

    ```text
    9mu9jQofVSNXFfqh5#vjMGYSjGSCN7gfpiU7
    ```

### Hoe te implementeren?

Volg de [Best Practice - Wachtwoorden](../Best%20Practices/Best%20Practice%20-%20Wachtwoorden.md)

## 2.1.2 Verify that passwords of at least 64 characters are permitted, and that passwords of more than 128 characters are denied

Zoals hierboven aangegeven is het gebruik van lange wachtwoorden aanbevolen. Hierbij is het wel belangrijk dat er een limit wordt ingesteld om te voorkomen dat er een Denial of Service (DoS) kan plaatsvinden waarbij een wachtwoord wordt opgegeven dat zo lang is dat er veel computer resources worden gebruikt.

### Hoe te testen?

#### Optie 1 (manueel)

1. Controleer of het mogelijk is om het volgende wachtwoord te gebruiken:

    ```text
    9mu9jQofVSNXFfqh5#vjMGYSjGSCN7gfpiU7xJzweP%PmgzKcmp6Ps^cSSsRWQ2iSwyfZX@qA^S26HL#bVWQfd3mc@ZFZXzN4u3qwZt2fAfnYwUACPFHC8pRD#^^xNqb
    ```

2. Controleer dat het niet mogelijk is om het volgende wachtwoord te gebruiken:

    ```text
    9mu9jQofVSNXFfqh5#vjMGYSjGSCN7gfpiU7xJzweP%PmgzKcmp6Ps^cSSsRWQ2iSwyfZX@qA^S26HL#bVWQfd3mc@ZFZXzN4u3qwZt2fAfnYwUACPFHC8pRD#^^xNqbtoolong
    ```

### Hoe te implementeren?

Volg de [Best Practice - Wachtwoorden](../Best%20Practices/Best%20Practice%20-%20Wachtwoorden.md)

## 2.1.3 Verify that password truncation is not performed. However, consecutive multiple spaces may be replaced by a single space

Dit items focust op het feit dat soms als truc een wachtwoord wordt verkort om te kunnen gebruiken met bijvoorbeeld het hashing algoritme. Een mooi voorbeeld is <https://gitlab.com/gitlab-org/gitlab/-/issues/220580>. Deze hebben we ook gebruikt voor onze test case. Wat het inhoudt is dat bijvoorbeeld een wachtwoord van 128 karakters kan worden opgegeven, echter vindt er "truncation" plaats waardoor er maar 72 karakters worden gebruikt bij het hashen van het wachtwoord. Hierdoor wordt het mogelijk om met een korter wachtwoord in te loggen.

### Hoe te testen?

#### Optie 1 (via code)

Is om het in je code te bekijken. Hierbij duidt het gebruik van bijvoorbeeld example_string.Substring(0,72); op het truncaten van wachtwoorden.

#### Optie 2 (Manueel)

1. Gebruik het wachtwoord: `abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwx`
2. Probeer in te loggen met `abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrst`

### Hoe te implementeren?

Volg de [Best Practice - Wachtwoorden](../Best%20Practices/Best%20Practice%20-%20Wachtwoorden.md)

## 2.1.4 Verify that any printable Unicode character, including language neutral characters such as spaces and Emojis are permitted in passwords

Dit items focust op het feit dat Unicode een stuk meer tekens heeft dan alleen de bekende a-z en !@#$$%^&* . Een mooi overzicht kan hier worden gevonden: <https://symbl.cc/en/unicode-table/>. Voorbeelden zijn: ▲ of ◔ en ga zo maar door.

### Hoe te testen?

#### Optie 1 (manueel)

1. Stel het onderstaande wachtwoord in:

    ```text
    ɶ(◕‿◕)֍֍T!1߷ɶ߷ɶ߷ɶ߷T!2(◕‿◕)
    ```

2. Verifieer dat het mogelijk is succesvol in te loggen met het wachtwoord.

### Hoe te implementeren?

Volg de [Best Practice - Wachtwoorden](../Best%20Practices/Best%20Practice%20-%20Wachtwoorden.md)

## 2.1.5 Verify users can change their password

Binnen je applicatie moet het mogelijk zijn om een wachtwoord te wijzigen. Dit zodat, indien een wachtwoord uitlekt of een gebruiker een ander wachtwoord wil gebruiken dit mogelijk is.

### Hoe te testen?

#### Optie 1 (manueel)

1. Wijzig het wachtwoord van een gebruiker
2. Test of het mogelijk is om weer in te loggen met dit nieuwe wachtwoord.

### Hoe te implementeren?

Implementeer een wachtwoord wijzigen pagina, gebruik <https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/04-Authentication_Testing/09-Testing_for_Weak_Password_Change_or_Reset_Functionalities> als referentie.

## 2.1.6 Verify that password change functionality requires the user's current and new password

Omdat er verschillende aanvalsmethoden zijn om een gebruiker acties te laten uitvoeren in het belangrijk dat er wel een controle zit wanneer een wachtwoord wordt gewijzigd. In de meeste gevallen, en ook in dit geval is het hierbij nuttig om het huidige wachtwoord ook te verifiëren. Hierdoor is de kans dat bijvoorbeeld bij een CSRF, of clickjacking aanval een wachtwoord gewijzigd kan worden kleiner. Hierbij is het belangrijk dat dit op de server gebeurd. Dit om de security te waarborgen omdat de client in handen is van een gebruiker en mogelijk een aanvaller.

### Hoe te testen?

#### Optie 1 (manueel)

Stel een nieuwe wachtwoord in en controleer of het oude wachtwoord ook nodig is. Belangrijk! Controleer dit aan de kant van de server, niet alleen in de client (webbrowser).

### Hoe te implementeren?

Voeg een verificatie stap toe met het huidige wachtwoord gedurende een wachtwoord wijziging stap, gebruik <https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/04-Authentication_Testing/09-Testing_for_Weak_Password_Change_or_Reset_Functionalities> als referentie.

## 2.1.7 Verify that passwords submitted during account registration, login, and password change are checked against a set of breached passwords

In het nieuws lees je vaak genoeg over "password breaches" waar grote hoeveelheid wachtwoorden uitlekken. Omdat mensen snel geneigd zijn om wachtwoorden op meerdere plekken gebruikt worden is het belangrijk om te verifiëren dat deze niet voorkomt in een bestaande database van gelekte wachtwoorden.

### Hoe te testen?

#### Optie 1 (manueel)

1. Onderzoek of tijdens het kiezen van een wachtwoord via de code wordt gecontroleerd dat het wachtwoord niet in een leaked database voorkomen.
2. Verifieer dat er geen plain text wachtwoorden verstuurd worden naar third party's voor deze functionaliteit.
3. Verifieer dat er geen plain text wachtwoorden verstuurd worden naar API's voor deze functionaliteit.

### Hoe te implementeren?

HaveIBeenPwned heeft een API waarmee deze controle kan worden gedaan: <https://haveibeenpwned.com/API/v3>.

* Het is aanbevolen indien mogelijk de hashes en checks lokaal te doen.
* Indien de API wordt gebruikt is het belangrijk dat er geen emails of persoonlijke informatie wordt gedeeld.
* Een voorbeeld implementatie kan worden gevonden op <https://github.com/HaveIBeenPwned/PwnedPasswordsDownloader>.

## 2.1.8 Verify that a password strength meter is provided to help users set a stronger password

Om gebruikers te begeleiden in het gebruik van een goed wachtwoord zijn visuele hulpmiddelen essentieel. Dit zorgt er namelijk voor dat gebruikers voor een veiliger wachtwoord gaan en begeleid worden in het kiezen van een wachtwoord.

### Hoe te testen?

#### Optie 1 (manueel)

1. Bij het inloggen is een wachtwoord meter zichtbaar.
2. Controleer dat het volgende wachtwoord wordt gezien als sterk:

    ```text
    exhume-rekindle2-stainless-crested-tightrope
    ```

3. Controleer dat het volgende wachtwoord wordt gezien als zwak:

    ```text
    Passw0rd1!
    ```

### Hoe te implementeren?

Maak gebruik van een wachtwoord strength meter. e.g. <https://github.com/zxcvbn-ts/zxcvbn>. Let op dat je gebruik maakt van een betrouwbare meter, het is bekend dat er versies zijn die met trucs bepaalde slechte wachtwoorden alsnog als 'goed' kenmerken.

## 2.1.9 Verify that there are no password composition rules limiting the type of characters permitted. There should be no requirement for upper or lower case or numbers or special characters

De lengte van een wachtwoord is vaak belangrijker dan de tekens die gebruikt worden. Wel is het belangrijk dat aan vreemde tekens geen eisen zitten, e.g. alleen de tekens '#@!/' zijn toegestaan.

### Hoe te testen?

#### Optie 1 (manueel)

Controleer dat er geen eisen worden gesteld aan het wachtwoord behalve de lengte.

### Hoe te implementeren?

Volg de [Best Practice - Wachtwoorden](../Best%20Practices/Best%20Practice%20-%20Wachtwoorden.md)

## 2.1.10 Verify that there are no periodic credential rotation or password history requirements

In het verleden is er door NIST (security instantie) het advies afgegeven om wachtwoorden periodiek te rouleren en hierbij geen wachtwoorden te gebruiken die al eerder gebruikt zijn. Dit wordt tegenwoordig echter afgeraden omdat dit verkeer gedrag aanmoedigen, e.g. makkelijk maken omdat je het kunt onthouden en een 1 in een 2 veranderen bijvoorbeeld.

### Hoe te testen?

#### Optie 1 (configuratie)

Bekijk de configuratie van de user management om te kijken of hier wachtwoord roulering of wachtwoord geschiedenis aanstaat.

#### Optie 2 (manueel)

Let op: Deze methode kan lang duren en is niet aanbevolen.

1. Maak een account aan.
2. Wacht een periode van enkele maanden tot 1 jaar.
3. Kijk of het wachtwoord nog geldig is.

### Hoe te implementeren?

Configureer de server zo dat er geen wachtwoord rotaties en wachtwoord geschiedenis wordt geforceerd.

## 2.1.11 Verify that "paste" functionality, browser password helpers, and external password managers are permitted

Vanuit security word vaak het advies gegeven om een wachtwoord manager te gebruiken. Dit omdat het hierdoor makkelijker wordt om sterke wachtwoorden te gebruiken zonder dat deze onthouden hoeven te worden. Echter is het dan niet fijn als dit actief door een website of applicatie wordt geblokkeerd waardoor je bijvoorbeeld handmatig een wachtwoord moet overtypen met als gevolg dat er in de meeste gevallen voor een korter en onveiliger wachtwoord wordt gekozen.

### Hoe te testen?

#### Optie 1 (manueel)

1. Installeer een paswoord manager plugin in je browser. E.g. <https://bitwarden.com/nl-nl/>.
2. Sla je credentials op in je wachtwoord manager.
3. Ga naar de inlogpagina.
4. Autofill wachtwoord en log in.

### Hoe te implementeren?

Zonder specifieke instellingen om dit te blokkeren zou dit in de meeste gevallen gewoon moeten werken. Indien het niet werkt is het aanbevolen de restrictieve instellingen te verwijderen.

## 2.1.12 Verify that the user can choose to either temporarily view the entire masked password, or temporarily view the last typed character of the password on platforms that do not have this as built-in functionality

Omdat het bij lange wachtwoorden voor kan komen dat er een typefout wordt gemaakt is het fijn als het ingetikte wachtwoord kort tijdig kan worden ingezien om de typefout eruit te halen, of om te kijken waarom een wachtwoord manager niet werkt. Dit is dan ook vooral een gebruiksvriendelijkheid toevoeging.

### Hoe te testen?

#### Optie 1 (manueel)

1. Vul het wachtwoord in bij de inlog pagina.
2. Kijk of het mogelijk is om de "mask", e.g. ****, tijdelijk om te zetten naar leesbare karakters.

### Hoe te implementeren?

Alle standaard wachtwoord invoervelden ondersteunen dit in de meeste gevallen. Zo niet is het advies om te kijken hoe dit aangezet kan worden voor het gekozen framework.
