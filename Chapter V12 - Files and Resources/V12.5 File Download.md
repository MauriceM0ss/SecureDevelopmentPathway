# V12.5 File Download

## 12.5.1 Verify that the web tier is configured to serve only files with specific file extensions to prevent unintentional information and source code leakage. For example, backup files (e.g. .bak), temporary working files (e.g. .swp), compressed files (.zip, .tar.gz, etc) and other extensions commonly used by editors should be blocked unless required

Soms komt het onbedoeld voor dat bestanden in de web root terecht komen, denk bijvoorbeeld aan backups in .bak bestanden. Hierbij is het belangrijk dat deze niet via de website zijn te downloaden om te voorkomen dat mogelijk gevoelige gegevens of source code hiermee uitlekt.

### Hoe te testen?

#### Optie 1 (manueel)

1. Ga door de bestanden in de web root folder.
2. `ffind -p /var/www/html`
3. Controleer dat er geen gevoelige bestanden tussen staan.

### Hoe te implementeren?

1. Identificeer toegestane bestand extensies.
2. Zorg dat ongewenste extensies terug komen in je .gitignore.
3. Stel de webserver zo in dat alleen de geïdentificeerde veilige bestand extensies worden geserveerd. Voor Apache kan dit bijvoorbeeld met de `FilesMatch` en `mod_rewrite` modules.

## 12.5.2 Verify that direct requests to uploaded files will never be executed as HTML/JavaScript content

Op het moment dat HTML of JavaScript in de context van de applicatie worden uitgevoerd betekend dit dat hierbij ook toegang tot informatie van de server kan worden verkregen, hierdoor kunnen bijvoorbeeld cookies uitlekken.

### Hoe te testen?

#### Optie 1 (manueel)

1. Upload een HTML bestand, e.g.

    ```html
    <html><body><h1>Dit is een titel<h1></body></html>
    ```

2. Download het document en kijk of het als bijlage wordt geopend.

### Hoe te implementeren?

Voeg de `Content-Disposition` header toe bij het openen van bijlages.

```text
Content-Disposition: attachment; filename=“example.html”
```
