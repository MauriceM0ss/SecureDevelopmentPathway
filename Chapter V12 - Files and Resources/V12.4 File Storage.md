# V12.4 File Storage

## 12.4.1 Verify that files obtained from untrusted sources are stored outside the web root, with limited permissions

Op het moment dat externe bestanden worden ontvangen is het belangrijk dat deze nooit in de web root worden opgeslagen, dit om te voorkomen dat ze via de applicatie opgevraagd kunnen worden waardoor de ge端ploade bestanden mogelijk in de context van de applicatie worden uitgevoerd.

### Hoe te testen?

#### Optie 1 (manueel)

1. Onderzoek waar bestanden worden ge端pload.
2. Verifieer dat deze worden ge端pload in een losstaande server of folder.
3. Controleer dat bestanden minimale rechten hebben.

### Hoe te implementeren?

1. Sla bestanden op, op een externe host probeer hier de de systemen zo in te richten dat er segregatie ontstaat.
2. Als alternatief, bewaar de bestanden buiten de webroot, waar alleen administratieve toegang is toegestaan.

Zie voor meer informatie:
<https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html#file-storage-location>

## 12.4.2 Verify that files obtained from untrusted sources are scanned by antivirus scanners to prevent upload and serving of known malicious content

Voordat bestanden opgeslagen worden op een server is het belangrijk om eerst te controleren dat ze niet malafide zijn. Hiervoor kan een antivirus scanner worden gebruikt, die de ge端ploade bestanden scanned voor mogelijke malware.

### Hoe te testen?

#### Optie 1 (manueel)

1. Maak gebruik van de zogenaamde eicar string. Deze zou virusscanners moeten triggeren om een alert te genereren.

    ```text
    X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
    ```

### Hoe te implementeren?

Dit is zeer afhankelijk van je omgeving. Het is aanbevolen de best practices te volgen als beschreven in [File Upload Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html#file-storage-location)
