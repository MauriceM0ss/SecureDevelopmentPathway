# V9.1 Client Communication Security

## 9.1.1 Verify that TLS is used for all client connectivity, and does not fall back to insecure or unencrypted communications

Het is belangrijk dat verkeer wordt versleuteld door het gebruik van TLS, dit waarborgt dat data niet wordt onderschept (vertrouwelijkheid) maar ook dat data niet wordt veranderd (integriteit). Hierbij beschikken aanvallers over methodes om de meest onveilige encryptie methode te kiezen waardoor het mogelijk makkelijker wordt om de encryptie toch te omzeilen.

### Hoe te testen?

#### Optie 1 (via SSL Server Test)

1. Scan met <https://www.ssllabs.com/ssltest/> (zorg dat de optie `Do not show the results on the boards` is aangevinkt)
2. Controleer of overal TLS wordt gebruikt.
3. Controleer of de HSTS header wordt meegestuurd op elke response.

#### Optie 2 (via script)

1. Gebruik het script op <https://github.com/drwetter/testssl.sh> om de SSL ciphers te testen.
2. Controleer of overal TLS wordt gebruikt.
3. Controleer of de HSTS header wordt meegestuurd op elke response.

### Hoe te implementeren?

#### Optie 1 (via SSL Server Test)

Implementeer de [HSTS Headers](../Best%20Practices/Best%20Practice%20-%20Security%20Headers%20-%20HSTS.md)

Volg de [Best Practice - Cryptografie](../Best%20Practices/Best%20Practice%20-%20Cryptografie.md)

## 9.1.2 Verify using up to date TLS testing tools that only strong cipher suites are enabled, with the strongest cipher suites set as preferred

Om de gegevens van een gebruiker te beschermen is het belangrijk dat er veilige encryptie methodes gebruikt worden. Om deze reden is het aanbevolen om periodiek na te lopen met geschikte tools of dit ook daadwerkelijk het geval is.

### Hoe te testen?

#### Optie 1 (via SSL Server Test)

1. Scan met <https://www.ssllabs.com/ssltest/> (zorg dat de optie `Do not show the results on the boards` is aangevinkt)
2. Controleer of overal TLS wordt gebruikt.
3. Controleer dat er geen verouderde protocollen en/of ciphers worden gebruikt en dat onveilige configuraties zoals `Insecure renegotiation` uit staan.

#### Optie 2 (via script)

1. Gebruik het script op <https://github.com/drwetter/testssl.sh> om de SSL ciphers te testen.
2. Controleer of overal TLS wordt gebruikt.
3. Controleer dat er geen verouderde protocollen en/of ciphers worden gebruikt en dat onveilige configuraties zoals `Insecure renegotiation` uit staan.

### Hoe te implementeren?

1. Ga voor een A+ indien mogelijk in SSLLabs.
2. Definieer waarom er uitzonderingen gemaakt worden en review deze periodiek.
3. Volg de [Best Practice - Cryptografie](../Best%20Practices/Best%20Practice%20-%20Cryptografie.md)

## 9.1.3 Verify that only the latest recommended versions of the TLS protocol are enabled, such as TLS 1.2 and TLS 1.3. The latest version of the TLS protocol should be the preferred option

Met de introductie van TLS 1.3 is er weer een stap gemaakt in veiliger gebruik van TLS. Echter voor backwards compatibiliteit worden er nog oudere ciphers ondersteund. Hierbij is het aanbevolen om het advies van de NSCS (verwerkt in onze best practices) te gebruiken en ook periodiek na te lopen of deze vernieuwd zijn.

### Hoe te testen?

#### Optie 1 (via SSL Server Test)

1. Scan met <https://www.ssllabs.com/ssltest/> (zorg dat de optie `Do not show the results on the boards` is aangevinkt)
2. Controleer of overal TLS 1.3 en optioneel 1.2 wordt gebruikt.

#### Optie 2 (via script)

1. Gebruik het script op <https://github.com/drwetter/testssl.sh> om de SSL ciphers te testen.
2. Controleer of overal TLS 1.3 en optioneel 1.2 wordt gebruikt.

### Hoe te implementeren?

1. Ga voor een A+ indien mogelijk in SSLLabs.
2. Definieer waarom er uitzonderingen gemaakt worden en review deze periodiek.
3. Volg de [Best Practice - Cryptografie](../Best%20Practices/Best%20Practice%20-%20Cryptografie.md)
