# V8.2 Client-side Data Protection

## 8.2.1 Verify the application sets sufficient anti-caching headers so that sensitive data is not cached in modern browsers

Browsers bieden standaard functionaliteit om data te cachen, dit om de snelheid van een pagina te versnellen op het moment dat deze opnieuw wordt ingeladen. Toch is het in veel gevallen beter om cache te verwijderen zodat andere gebruikers van de computer deze niet op een later moment nog kunnen inzien.

### Hoe te testen?

#### Optie 1 (via curl)

1. Via een terminal verstuur het volgende commando:

    ```bash
    curl -s -D- https://vws-exampe.nl | grep -i cache
    ```

De verwachte response is: `Cache-Control: no-store, max-age=0`

### Hoe te implementeren?

Implementeer de header `Cache-Control: no-store, max-age=0`

Voor meer informatie zie: [Best Practice - Cache-Control](../Best%20Practices/Best%20Practice%20-%20Security%20Headers%20-%20Cache-Control.md)

## 8.2.2 Verify that data stored in browser storage (such as localStorage, sessionStorage, IndexedDB, or cookies) does not contain sensitive data

Moderne browsers beschikken over steeds meer mogelijkheden om een pagina sneller te maken door middel van het lokaal opslaan van data, dit voorkomt dat data bij elke request opnieuw van de server moet worden opgehaald. Toch is het belangrijk dat gevoelige data niet wordt opgeslagen om te voorkomen dat kwaadwillende deze informatie uit de browser kunnen achterhalen als ze bijvoorbeeld toegang hebben tot de computer.

### Hoe te testen?

#### Optie 1 (manueel)

Volg de checks zoals beschreven in: <https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/12-Testing_Browser_Storage>

### Hoe te implementeren?

Zorg er voor dat gevoelige data nooit client side wordt opgeslagen.

Voor meer informatie, zie <https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#storage-apis>

## 8.2.3 Verify that authenticated data is cleared from client storage, such as the browser DOM, after the client or session is terminated

Indien toegang wordt verkregen tot een browser is het mogelijk om de storage van een browser in te zien. Als hier gevoelige data instaat kan dit mogelijk bekeken en mogelijk misbruikt worden door een kwaadwillende. Om deze reden is het belangrijk om deze data te verwijderen nadat een sessie wordt afgesloten.

### Hoe te testen?

#### Optie 1 (manueel)

1. Log in en genereer data die in de storage wordt opgeslagen.
2. Log uit
3. Open de browser Developer Tools (F12) en ga naar storage
4. Kijk of er nog gevoelige data beschikbaar is.

### Hoe te implementeren?

Implementeer de volgende headers bij het uitloggen, deze zal de browser sessie en informatie verwijderen en vervolgens de pagina verversen::

```text
Clear-Site-Data: "cache", "cookies", "storage", "executionContexts"
```

Voor meer informatie, zie [Best Practice - Clear-Site-Data](../Best%20Practices/Best%20Practice%20-%20Security%20Headers%20-%20Clear-Site-Data.md)
