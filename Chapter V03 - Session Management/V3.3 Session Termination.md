# V3.3 Session Termination

## 3.3.1 Verify that logout and expiration invalidate the session token, such that the back button or a downstream relying party does not resume an authenticated session, including across relying parties

Wanneer een gebruiker uitlogt is het belangrijk om dit ook te communiceren met de achterliggende systemen. Als dit niet gedaan wordt is het namelijk mogelijk om zelfs na het uitloggen een sessie nog te gebruiken. Dit vergroot niet alleen de kans dat aanvallers een actieve sessie kunnen achterhalen maar kan ook een gebruiker de mogelijkheid geven om malafide acties uit te voeren en te claimen dat hij was uitgelogd.

### Hoe te testen?

#### Optie 1 (manueel)

1. Log in met een gebruiker.
2. Noteer de sessie token
3. Log de gebruiker uit
4. Druk op terug in de browser en kijk of de sessie nog actief is.
5. Gebruik de genoteerde sessie token in een nieuwe verzoek en controleer of deze nog actief is.

### Hoe te implementeren?

1. Geef een signaal naar de back-end op het moment dat een gebruiker uitlogt.
2. In het geval van bijvoorbeeld JWT tokens maak gebruik van "exp" om tokens te laten verlopen.

Voor meer informatie zie ook: [Best Practice - Clear-Site-Data](../Best%20Practices/Best%20Practice%20-%20Security%20Headers%20-%20Clear-Site-Data.md)

## 3.3.2 If authenticators permit users to remain logged in, verify that re-authentication occurs periodically both when actively used or after an idle period

Het is belangrijk dat in het geval dat gebruikers ingelogd mogen blijven er periodiek wel wordt gecontroleerd of de gebruiker nog beschikt over de benodigde gegevens, dit om te voorkomen dat een sessie onnodig actief blijft. Hierbij geldt afhankelijk van je type applicatie de volgende richtlijnen:

* Standaard: 30 dagen
* Applicatie met gevoelige data: 12 uur of 30 minuten van inactiviteit.
* Applicatie met zeer gevoelige data: 12 uur of 15 minuten van inactiviteit, verplicht MFA.

### Hoe te testen?

#### Optie 1 (manueel)

1. Log in op de applicatie en selecteer de optie om ingelogd te blijven.
2. Laat de applicatie een tijdje inactief (bijv. een uur). Keer daarna terug en controleer of je opnieuw moet inloggen

### Hoe te implementeren?

1. Bepaald welke standaard er geldt voor de applicatie op basis van gevoeligheid van data.
2. Zorg dat het inlog moment van een gebruiker wordt geregistreerd.
3. Zorg dat binnen het genoemde tijdframe de sessie ongeldig wordt verklaard en een nieuwe authenticatie wordt verplicht.
