# V3.4 Cookie-based Session Management

## 3.4.1 Verify that cookie-based session tokens have the 'Secure' attribute set

Deze setting zorgt er voor dat cookies enkel verstuurd kunnen worden via een HTTPS verbinding. Hierdoor is het niet mogelijk om de cookies in te zien door middel van bijvoorbeeld een man-in-the-middle attack zonder ook de TLS beveiliging te omzeilen. Daardoor wordt de kans dat het cookie uitlekt ook kleiner.

### Hoe te testen?

#### Optie 1 (via browser)

1. Login op de applicatie via een browser.
2. Open de ontwikkelaarstools (F12).
3. Ga naar "Storage" en dan "Cookies".
4. Controleer of Secure attribuut aanstaat.

#### Optie 2 (via curl)

Via een terminal verstuur het volgende commando:

```bash
curl -s -D- https://pgb-exampe.nl | grep -i set-cookie
```

### Hoe te implementeren?

Volg [Best Practice - HTTP Cookies](../Best%20Practices/Best%20Practice%20-%20HTTP%20Cookies.md)

## 3.4.2 Verify that cookie-based session tokens have the 'HttpOnly' attribute set

Deze setting zorgt er voor dat dat cookies enkel wordt verstuurd via het HTTP protocol. Dit bekent dat hij niet kan worden ingelezen door bijvoorbeeld javascript. Het voordeel hiervan is dat bij een Cross Side Scripting (XSS) aanval cookies niet zo maar uitlekken.

### Hoe te testen?

#### Optie 1 (via browser)

1. Login op de applicatie via een browser.
2. Open de ontwikkelaarstools (F12).
3. Ga naar "Storage" en dan "Cookies".
4. Controleer of "HttpOnly" attribuut aanstaat.

#### Optie 2 (via curl)

Via een terminal verstuur het volgende commando:

```bash
curl -s -D- https://pgb-exampe.nl | grep -i set-cookie
```

### Hoe te implementeren?

Volg [Best Practice - HTTP Cookies](../Best%20Practices/Best%20Practice%20-%20HTTP%20Cookies.md)

## 3.4.3 Verify that cookie-based session tokens utilize the 'SameSite' attribute to limit exposure to cross-site request forgery attacks

Deze waarde verteld de browser dat de cookie enkel naar website mag worden gestuurd vanuit de website die de cookie heeft aangemaakt. Hierdoor is een aanval zoals Cross Side Request Forgery (CSRF) niet meer mogelijk, bij deze aanval wordt namelijk getracht cookies vanuit een externe website te sturen als naam van de originele website.

### Hoe te testen?

#### Optie 1 (via browser)

1. Login op de applicatie via een browser.
2. Open de ontwikkelaarstools (F12).
3. Ga naar "Storage" en dan "Cookies".
4. Controleer of "SameSite" attribuut aanstaat.

#### Optie 2 (via curl)

Via een terminal verstuur het volgende commando:

```bash
curl -s -D- https://pgb-exampe.nl | grep -i set-cookie
```

### Hoe te implementeren?

Volg [Best Practice - HTTP Cookies](../Best%20Practices/Best%20Practice%20-%20HTTP%20Cookies.md)

## 3.4.4 Verify that cookie-based session tokens use the "__Host-" prefix so cookies are only sent to the host that initially set the cookie

Door de keuze van bepaalde preset is het mogelijk om browsers te vertellen dat de cookie aan bepaalde eisen moet voldoen. Zo ook de `__Host  pefix`. Hierbij vertel je aan de browser dat de cookies minstens afkomstig moeten zijn van een veilige pagina (HTTPS), mogen niet naar subdomeinen worden gestuurd en het pad moet / zijn.

### Hoe te testen?

#### Optie 1 (via browser)

1. Login op de applicatie via een browser.
2. Open de ontwikkelaarstools (F12).
3. Ga naar "Storage" en dan "Cookies".
4. Controleer of de sessie cookie begint met `__Host-`.

#### Optie 2 (via curl)

Via een terminal verstuur het volgende commando:

```bash
curl -s -D- https://pgb-exampe.nl | grep -i set-cookie
```

### Hoe te implementeren?

Volg [Best Practice - HTTP Cookies](../Best%20Practices/Best%20Practice%20-%20HTTP%20Cookies.md)

## 3.4.5 Verify that if the application is published under a domain name with other applications that set or use session cookies that might disclose the session cookies, set the path attribute in cookie-based session tokens using the most precise path possible

Om er voor te zorgen dat het niet mogelijk is om met subdomeinen inzicht te krijgen tot een cookie. Stel dat een cookie alleen nodig is voor de API is het dan mogelijk om te zeggen path="api/v1", hierdoor is de kans minder groot dat deze uitlekt.

### Hoe te testen?

#### Optie 1 (via browser)

1. Login op de applicatie via een browser.
2. Open de ontwikkelaarstools (F12)
3. Ga naar "Storage" en dan "Cookies"
4. Controleer de "Path=" waarde

#### Optie 2 (via curl)

Via een terminal verstuur het volgende commando:

```bash
curl -s -D- https://pgb-exampe.nl | grep -i set-cookie
```

### Hoe te implementeren?

Volg [Best Practice - HTTP Cookies](../Best%20Practices/Best%20Practice%20-%20HTTP%20Cookies.md)
