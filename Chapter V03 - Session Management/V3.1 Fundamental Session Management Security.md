# V3.1 Fundamental Session Management Security

## 3.1.1 Verify the application never reveals session tokens in URL parameters

Omdat URL parameters vaak worden gecached, e.g. in browser, DNS, load balancers en/of applicatie logs, is de kans groter dat de waarde uitlekt, ook is de kans dat bij een verkeerd ingestelde [referer](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer) token de URL naar externe bronnen wordt verstuurd. Om deze reden dient de token nooit via een URL verstuurd te worden.

### Hoe te testen?

#### Optie 1 (via proxy)

Analyseer de verzoeken die binnen de applicatie worden verstuurd en kijk of hier sessie data in staat.

* Hoe dit te doen met Burp is te vinden op: <https://portswigger.net/burp/documentation/desktop/getting-started/intercepting-http-traffic>

#### Optie 2 (via browser)

Analyseer via de browser welke verzoeken er worden verstuurd, controleer of hier sessie data in voor komt.

* Mozilla <https://firefox-source-docs.mozilla.org/devtools-user/network_monitor/>
* Edge <https://learn.microsoft.com/en-us/microsoft-edge/devtools-guide-chromium/network/>
* Chrome <https://developer.chrome.com/docs/devtools/network>

#### Optie 3 (via code)

Controleer in de code dat er geen Sessie data in de URL wordt verstuurd.

### Hoe te implementeren?

Verstuur sessie data via headers, e.g. [Cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cookie) of [Authorization](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization).

Voor meer informatie zie: <https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html>
