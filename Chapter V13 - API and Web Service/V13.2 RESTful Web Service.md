# V13.2 RESTful Web Service

## 13.2.1 Verify that enabled RESTful HTTP methods are a valid choice for the user or action, such as preventing normal users using DELETE or PUT on protected API or resources

Met deze toegangscontrole zorg je ervoor dat niet-geautoriseerde modificaties of deletes niet zomaar uitgevoerd kunnen worden. Door de HTTP methods te limiteren tot geautoriseerde rollen of gebruikers zorg je voor de integriteit van je data, en de veiligheid van je API.

### Hoe te testen?

Er zijn een aantal manieren om te testen hoe dit op dit moment ingericht is in je applicatie:

#### Optie 1 (via CURL)

1. Met CURL vanuit een terminal kan je bijvoorbeeld "GET, POST, PUT, DELETE, PATCH, en OPTIONS" uitvoeren om te kijken welke geaccepteerd zijn vanuit verschillende gebruikers en/ of rollen:

    ```bash
    curl -X PUT -d argument=value -d argument2=value2 http://vws-example.nl:8080
    ```

#### Optie 2 (via DAST)

Je kan geautomatiseerde kwetsbaarheid scanners gebruiken zoals OWASP ZAP of Burp Suite. Ons SAT (Security Assessment Team) gebruikt Burp Suite en test op verscheidende HTTP Methods.

### Hoe te implementeren?

Voor een correcte implementatie van de RESTful HTTP methods kan je de best practices over de REST Security van de [OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/cheatsheets/REST_Security_Cheat_Sheet.html) volgen.

## 13.2.2 Verify that JSON schema validation is in place and verified before accepting input

Dit is een requirement die ervoor zorgt dat alle JSON-invoer die door een applicatie wordt ontvangen, wordt gevalideerd tegen een vooraf (door ons) gedefinieerd schema. Dit schema definieert de structuur, vereiste velden, datatypes en eventuele beperkingen van de JSON-gegevens.

Waarom willen we dit: het voorkomt ongeldige gegevens (alleen de goed gevormde & verwachte gegevens worden geaccepteerd), beschermt tegen injectie aanvallen en verminderd het risico op security problemen door ervoor te zorgen dat de gegevensstructuur en inhoud aan onze verwachte normen voldoen.

### Hoe te testen?

#### Optie 1 (manueel)

Review de codebase in je IDE:

* Zoek naar codefragmenten die JSON-gegevens verwerken
* Controleer of er een verwijzing is naar een JSON-schema en of er validatie plaatsvindt tegen dit schema

#### Optie 2 (via tools)

Er zijn test-tools beschikbaar om JSON-validatie te kunnen controleren, zoals [JSON Schema Lint](https://jsonschemalint.com/)

### Hoe te implementeren?

Volg de [Best Practice - JSON Schema Validation](../Best%20Practices/Best%20Practice%20-%20JSON%20Schema%20Validation.md) handleiding over hoe de JSON schema het beste te implementeren.

## 13.2.3 Verify that RESTful web services that utilize cookies are protected from Cross-Site Request Forgery via the use of at least one or more of the following: double submit cookie pattern, CSRF nonces, or Origin request header checks

Op het moment dat cookies van REST API's niet beschermd zijn tegen CSRF aanvallen is het mogelijk voor een aanvaller om via een externe website de API aan te roepen. De manier waarop browsers werken worden de lokale cookies behorende bij de applicatie meegestuurd, dit betekent dat authenticatie en autorisatie stappen worden omzeilt waardoor beschermde acties uitgevoerd kunnen worden.

### Hoe te testen?

#### Optie 1 (manueel)

1. [OWASP Testing Guide](https://github.com/ManhNho/OWASP-Testing-Guide-v5/blob/master/document/4%20Web%20Application%20Security%20Testing/4.7%20Session%20Management%20Testing/4.7.5%20Testing%20for%20CSRF%20(OTG-SESS-005).md)
2. [Portswigger Web Security](https://portswigger.net/web-security/csrf)
3. Voor het uitvoeren van een code review zie: [OWASP Code Review Guide for CSRF Issue](https://owasp.org/www-project-code-review-guide/reviewing-code-for-csrf-issues)

#### Optie 2 (via SAST)

SAST tooling is in staat om CSRF aanvallen te detecteren.

### Hoe te implementeren?

Volg de mitigerende best practices genoemd in de [OWASP Cheat Sheet series]( https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html) voor de CSRF preventie.
