# V14.3 Unintended Security Disclosure

## 14.3.2 Verify that web or application server and application framework debug modes are disabled in production to eliminate debug features, developer consoles, and unintended security disclosures

Door de debug modes in de productie uit te schakelen, wordt de blootstelling van gevoelige informatie beperkt en wordt het risico op onbedoelde beveiligingsproblemen verminderd die door aanvallers kunnen worden uitgebuit. In uitzonderlijke gevallen kan debug mode zelfs leiden tot het overnemen van de server, e.g. met [Laravel](https://www.ambionics.io/blog/laravel-debug-rce).

### Hoe te testen?

#### Optie 1 (manueel)

1. Check de config files voor instellingen zoals 'debug', 'development' of 'console', en of deze attributen de waarde 'false' hebben;
2. Onderzoek de log bestanden of ze niet te veel debug informatie bevatten;
3. Probeer de URL van je applicatie te openen met bijvoorbeeld '/debug' of '/console';

#### Optie 2 (via Pentest)

Maak gebruik van een Pentest.

### Hoe te implementeren

Op dit moment is het nog in onderzoek. Beide het beleid moet gecheckt worden EN methodes van logging moet gecheckt worden. Zodra dit bekend is, kan dit punt aangevuld/ verbeterd worden.

## 14.3.3 Verify that the HTTP headers or any part of the HTTP response do not expose detailed version information of system components

Door gedetailleerde versie-informatie uit HTTP-headers en -responses te verwijderen, kunnen aanvallers specifieke softwareversies identificeren, die kunnen worden gebruikt om bekende kwetsbaarheden in verband met die versies te misbruiken. Wordt vaak gebruikt om informatie te verzamelen over een omgeving in de reconnaissance fase van een Pentest, maar ook bij een daadwerkelijke aanval.

### Hoe te testen?

#### Optie 1 (manueel)

Open de pagina in je browser en open de Development Tools

* Open de "Network" tab en refresh de pagina;
* Check of en wat voor informatie bij de HTTP Headers staat (bijv. Server, X-Powered-By, X-AspNet-Version, X-Powered-By).

Voorbeeld van te veel versie informatie (in de `Server` header):

```text
HTTP/1.1 200 OK
Date: Thu, 12 Jun 2014 14:15:01 GMT
Server: Apache/2.2.21 (Win32) PHP/5.4.7
Content-Length:226
Connection: close
Content-Type: text/html; charset=iso-8859-1
```

#### Optie 2 (via Curl)

Voer het onderstaande commando uit en check voor headers die versie-informatie verklappen

```bash
curl -I https://example.nl
```

#### Optie 3 (via Security Headers)

Check de website via bijvoorbeeld <https://securityheaders.com>

### Hoe te implementeren?

Gebruik bijvoorbeeld de Apache ingebouwde functionaliteit om headers aan te passen, bijvoorbeeld in .htaccess:

* ServerSignature Off
* ServerTokens Prod

Er zijn veel verschillende toepassingen en frameworks om dit op te kunnen lossen, hieronder vind je een aantal links naar voorbeelden over hoe je dit kan uitvoeren.

* [Apache ServerTokens Directive](https://httpd.apache.org/docs/2.4/mod/core.html#servertokens)
* [Apache ServerSignature Directive](https://httpd.apache.org/docs/2.4/mod/core.html#serversignature)
* [Nginx Configuration Directives](https://www.oreilly.com/library/view/nginx-http-server/9781788623551/e9e0bb82-ffc2-4044-b980-63b49fa50580.xhtml#:~:text=If%20you%20set%20server_tokens%20to,build%20value%20specified%20during%20compilation)
* [Remove Server Header is IIS](https://docs.microsoft.com/en-us/iis/configuration/system.webserver/httpprotocol/)
* [Node.JS (Express) Hiding Version Information](https://expressjs.com/en/advanced/best-practice-security.html)
* [Java (Spring Boot)](https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-security)
* [Hiding PHP Version Information](https://www.php.net/manual/en/function.header-remove.php)

In het kort: gebruik waar mogelijk de ingebouwde functionaliteit van de oplossing die je gebruikt, in plaats van zelf custom headers te bouwen. Als die functionaliteit er niet is, patchen patchen patchen!
