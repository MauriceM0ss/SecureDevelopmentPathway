# V14.2 Dependency

## 14.2.1 Verify that all components are up to date, preferably using a dependency checker during build or compile time

Door componenten up-to-date te houden, wordt voorkomen dat beveiligingsproblemen van oudere versies worden misbruikt, en kan je voorkomen dat er zich grote security problemen voordoen op een later stadium in het development proces.

### Hoe te testen?

#### Optie 1 (via vulnerability SCA)

Kijk of je een vulnerability scanner hebt in je pipeline. Bijvoorbeeld SCA tooling als de [OWASP Dependency Checker](https://owasp.org/www-project-dependency-check/), [Snyk](https://snyk.io/product/open-source-security-management/) of [Trivy](https://github.com/aquasecurity/trivy).

### Hoe te implementeren?

1. Implementeer een Vulnerability Scanner / SCA in je pipeline die kijkt naar de libraries en dependencies van je oplossing.
2. Volg de best practices van OWASP: [OWASP Top Ten Proactive Controls 2018 | C2: Leverage Security Frameworks and Libraries | OWASP Foundation](https://owasp.org/www-project-proactive-controls/v3/en/c2-leverage-security-frameworks-libraries).
3. Zorg dat er duidelijke afspraken zijn voor het mitigeren van bevindingen.

## 14.2.2 Verify that all unneeded features, documentation, sample applications and configurations are removed

Het verwijderen van onnodige functies, documentatie, voorbeeldapplicaties en configuraties verkleint het aanvalsoppervlak, minimaliseert potentiële kwetsbaarheden en maakt de applicatie veiliger. Bovendien maakt het de mogelijkheid tot reconnaissance van kwaadwillenden kleiner: hoe minder overbodige informatie hoe beter.

### Hoe te testen?

#### Optie 1 (via code review)

Dit kan je controleren door een Code Review uit te laten voeren, een configuration (files) review te doen, de bestanden te checken, geautomatiseerde scanners (zoals een Linter) te gebruiken of manueel te testen door de applicatie door te browsen.

### Hoe te implementeren?

Zorg dat je een Development Lifecycle hebt, met hierbij ook een 'Decommissioning/ Legacy Management' proces. Zie hiervoor [System Decommissioning / Legacy Management (owaspsamm.org)](https://owaspsamm.org/model/operations/operational-management/stream-b/).

## 14.2.3 Verify that if application assets, such as JavaScript libraries, CSS or web fonts, are hosted externally on a Content Delivery Network (CDN) or external provider, Subresource Integrity (SRI) is used to validate the integrity of the asset

Het gebruik van Subresource Integrity (SRI) zorgt ervoor dat er niet met extern gehoste assets zoals JavaScript-bibliotheken, CSS of web lettertypen is geknoeid, waardoor bescherming wordt geboden tegen kwaadwillige wijzigingen.

### Hoe te testen?

#### Optie 1 (manueel)

Open de pagina in je browser en open de Development Tools:

* Inspecteer de HTML bron en verifieer of de attributen 'integrity' en 'crossorigin' aanwezig zijn op je externe assets, binnen de  ```<script>, <link>, or <style>``` tags;
* Controleer de Network Requests op externe resource requests, en of deze succesvol geladen worden zonder fouten.
* Loop de CSP Header na, kijk of externe scripts uitgevoerd mogen worden of dat deze beperkt zijn (zie [Best Practice - Security Headers - CSP](../Best%20Practices/Best%20Practice%20-%20Security%20Headers%20-%20HSTS.md))

### Hoe te implementeren?

#### CSP Header

Zorg ervoor dat je in de CSP Header middels de directive 'SRCIPT-SRC' bepaald waar de scripts vandaan geladen mogen worden. Dit is de geprefereerde methode, al kan je met deze methode slechts controle behouden over *waar* je de scripts/ libraries vandaan trekt, niet of de scripts/ libraries zelf gecorrumpeerd zijn. zie voor details de [Best Practice - Security Headers - CSP](../Best%20Practices/Best%20Practice%20-%20Security%20Headers%20-%20HSTS.md)

#### SRI Hash

1. Genereer de SRI hash voor de externe asset (bijvoorbeeld via <https://www.srihash.org/>)
2. Voeg de SRI attribuut toe aan je code:
    * Gebruik hiervoor de 'Integrity' attribuut;
    * Gebruik de 'crossorigin' attribuut als de externe asset gehost wordt op een ander domein.

**Voorbeeld**:

```javascript
<script src="https://vws-example.nl/example-framework.js"
    integrity="sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC"
    crossorigin="anonymous"></script>
```

> [!TIP]
> Als je zelf host kun je nog een controle doen. Op het moment dat je een externe bron in laadt is deze controle vaak lastiger. Qua veiligheid zal het elkaar misschien niet veel uitmaken maar vaak zie je in de praktijk dat de externe hash gewoon wordt geüpdatet als er een update vanuit de leverancier komt, zonder dat er controle plaatsvindt wat er in het script is veranderd. Bij self hosting kun je deze controle mogelijk zelf doen.
