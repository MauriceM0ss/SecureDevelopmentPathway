# V10.3 Application Integrity

## 10.3.1 Verify that if the application has a client or server auto-update feature, updates should be obtained over secure channels and digitally signed. The update code must validate the digital signature of the update before installing or executing the update

Moderne IT maakt steeds meer gebruik van automatisering. Hierbij worden ook updates steeds meer geautomatiseerd. Om deze reden worden updates van een applicatie mogelijk blind geïnstalleerd, daarom is het belangrijk dat indien je applicatie auto-update ondersteund er een verificatie plaatsvindt die naloopt of de patch file gesigneerd is, hierdoor kunnen malafide packages niet via misbruik van het update beleid worden geïnstalleerd.

### Hoe te testen?

#### Optie 1 (manueel)

1. Zoek uit of automatische updates plaatsvinden vanuit de applicatie.
2. Controleer of hierbij een integriteitscheck plaatsvindt.
3. Controleer of er een policy is ingericht indien deze integriteitscheck faalt.

### Hoe te implementeren?

1. Implementeer procedures voor het uitvoeren van automatische updates.
    * Voor mogelijke input zie: [OWASP Top 10 2021 A08 - Software and Data Integrity Failures](https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/)

## 10.3.2 Verify that the application employs integrity protections, such as code signing or subresource integrity. The application must not load or execute code from untrusted sources, such as loading includes, modules, plugins, code, or libraries from untrusted sources or the Internet

Op het moment dat er externe bronnen worden ingeladen in de context van een applicatie is het belangrijk dat de integriteit van deze bronnen wordt geverifieerd, dit om te voorkomen dat de veiligheid van de applicatie wordt omzeilt op het moment dat de externe partij een veiligheidslek heeft.

### Hoe te testen?

#### Optie 1 (manueel)

1. Controleer dat alle code de `verified` melding heeft.
2. Controleer dat extern ingeladen component gebruik maken van SRI door bijvoorbeeld de `integrity=` tag.
3. Controleer dat indien script via de CSP worden ingeladen deze beschikken over een `nonce`.

### Hoe te implementeren?

* **Code Signing:** Volg de [Best Practice - Cryptografie](../Best%20Practices/Best%20Practice%20-%20Cryptografie.md), hierin staat aanbevolen `ED25519 met een minimum van 100 KDF (Key derivation function) rounds.`
* **Subresource Integrity (SRI):** <https://cheatsheetseries.owasp.org/cheatsheets/Third_Party_Javascript_Management_Cheat_Sheet.html#subresource-integrity>
* **Content Security Policy (CSP):** Volg de [Best Practice - CSP Header](../Best%20Practices/Best%20Practice%20-%20Security%20Headers%20-%20CSP.md)

## 10.3.3 Verify that the application has protection from subdomain takeovers if the application relies upon DNS entries or DNS subdomains, such as expired domain names, out of date DNS pointers or CNAMEs, expired projects at public source code repos, or transient cloud APIs, serverless functions, or storage buckets (*autogen-bucket-id*.cloud.example.com) or similar. Protections can include ensuring that DNS names used by applications are regularly checked for expiry or change

Subdomain takeover houdt in dat een aanvaller de controle over een subdomein kan krijgen dat niet meer in gebruik is of onjuist geconfigureerd is. Dit kan gebeuren als het DNS-record van een subdomein wijst naar een dienst of bron die niet meer bestaat of onder controle van de aanvaller is. Omdat het hierdoor lijkt dat dit domein van de rijksoverheid is, is dit extra schadelijk in een phishing campagne.

### Hoe te testen?

#### Optie 1 (manueel)

1. OWASP heeft een guide geschreven die uitleg hoe je kunt test voor `domain takeover`: [OWASP - Test for Subdomain Takeover](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/10-Test_for_Subdomain_Takeover)

#### Optie 2 (via tools)

1. Maak gebruik van tooling zoals Nessus of [OWASP Domain Project](https://github.com/domain-protect/domain-protect) voor het automatisch scannen van subdomains.

### Hoe te implementeren?

1. Zorg er voor dat er regelmatig wordt gemonitord op verlopen sub domeinen met bijvoorbeeld [OWASP Domain Project](https://github.com/domain-protect/domain-protect).
2. Verwijder de kwetsbare DNS resources van je configuratie.
